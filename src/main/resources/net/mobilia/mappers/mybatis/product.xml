<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Product">
	<select id="list_new" resultType="product">
		select * from (select * from product_list order by p_no desc) where rownum &lt;=8
	</select>
	<select id="list_md" resultType="product">
		select * from (select * from product_list where p_choice=1 order by p_no desc) where ROWNUM &lt;=8
	</select>
	<select id="list_count" resultType="int">
		select count(p_no) from product_list where p_class=#{c}
	</select>
	<select id="p_list" resultType="product">
		select * from product_list where p_class=#{c} order by p_no desc
	</select>
	<select id="list_count2" resultType="int">
		select count(p_no) from product_list where p_class=#{c} and p_category=#{state}
	</select>
	<select id="p_list2" resultType="product">
		select * from product_list where p_class=#{c} and p_category=#{state} order by p_no desc
	</select>
	<select id="p_list_m" resultType="product">
		select * from product_list where p_class=#{c}
		<if test="m == 'new'">
			order by p_no desc
		</if>
		<if test="m == 'low'">
			order by p_price asc
		</if>
		<if test="m == 'high'">
			order by p_price desc
		</if>
		<if test="m == 'best'">
			order by p_sold asc
		</if>
	</select >
	<select id="p_list_m2" resultType="product">
		select * from product_list where p_class=#{c} and p_category=#{state}
		<if test="m == 'new'">
			order by p_no desc
		</if>
		<if test="m == 'low'">
			order by p_price asc
		</if>
		<if test="m == 'high'">
			order by p_price desc
		</if>
		<if test="m == 'best'">
			order by p_sold asc
		</if>
	</select>
	<select id="p_info" resultType="product">
		select * from product_list where p_no=#{p_no}
	</select>
	<select id="r_count" resultType="int">
		select count(p_no) from review_p where p_no=#{p_no}
	</select>
	<select id="r_list" resultType="review">
		select * from (select rownum rNum,p_no,m_id,p_img1,p_name,re_no,re_cont,re_star,re_date
		from (select * from review_p order by re_no desc)) where rNum &gt;=#{startrow} 
		and rNum &lt;=#{endrow} and p_no=#{p_no}
	</select>
	<insert id="r_in">
		insert into review_p (p_no,m_id,p_img1,p_name,re_no,re_cont,re_star,re_date) 
		values(#{p_no},#{m_id},#{p_img1},#{p_name},re_no_seq.nextval,#{re_cont},#{re_star},sysdate)
	</insert>
	<select id="r_info" resultType="review">
		select * from review_p where re_no=#{re_no}
	</select>
	<update id="r_edit">
		update review_p set re_star=#{re_star},re_cont=#{re_cont} where re_no=#{re_no}
	</update>
	<delete id="r_del">
		delete review_p where re_no=#{re_no}
	</delete>
</mapper>